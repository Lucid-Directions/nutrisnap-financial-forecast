<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriSnap Financial Forecast Calculator</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Force breakdown grid layout - bypass any conflicts */
        .breakdown-grid {
            display: grid !important;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)) !important;
            gap: 12px !important;
            margin-bottom: 20px !important;
        }
        
        .metric-box {
            background-color: #1a1a1a !important;
            border: 1px solid #333 !important;
            border-radius: 8px !important;
            padding: 12px !important;
            display: flex !important;
            flex-direction: column !important;
            width: auto !important;
            max-width: none !important;
            margin: 0 !important;
        }
        
        .metric-box-title {
            font-size: 0.85rem !important;
            font-weight: 600 !important;
            color: #e5e7eb !important;
            margin: 0 0 10px 0 !important;
        }
        
        .metric-box-content {
            display: flex !important;
            flex-direction: column !important;
            gap: 6px !important;
        }
        
        .metric-item {
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            font-size: 0.75rem !important;
            padding-bottom: 6px !important;
            border-bottom: 1px solid #2a2a2a !important;
        }
        
        .metric-item:last-child {
            border-bottom: none !important;
            padding-bottom: 0 !important;
        }
        
        .metric-label {
            color: #9ca3af !important;
        }
        
        .metric-value {
            color: #667eea !important;
            font-weight: 500 !important;
            text-align: right !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🥗 NutriSnap Financial Forecast</h1>
            <p>Comprehensive financial modeling for your AI-powered nutrition app</p>
        </header>
        
        <div class="main-content">
            <div class="config-column">
                <!-- Core App Parameters -->
                <div class="card">
                    <h2 class="card-title">📱 Core App Parameters</h2>
                    <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div class="input-group">
                            <label>Monthly Price (£)
                                <span class="info-icon">?</span>
                                <span class="tooltip">The monthly subscription price for your premium tier users.</span>
                            </label>
                            <input type="number" id="appPrice" value="9.99" min="1" max="50" step="0.01">
                        </div>
                        
                        <div class="input-group">
                            <label for="annualDiscount">Annual Discount (%) <span class="help-icon" title="Discount offered for annual subscriptions to encourage longer commitments.">?</span></label>
                            <input type="range" id="annualDiscount" value="20" min="0" max="200" step="5" oninput="updateSliderValue(this); updateAnnualPrice()">
                            <span id="annualDiscountValue">20%</span>
                        </div>
                        
                        <div class="input-group">
                            <label for="annualPlanPercentage">Annual Plan Adoption (%) <span class="help-icon" title="Percentage of users who choose annual over monthly billing.">?</span></label>
                            <input type="range" id="annualPlanPercentage" value="30" min="0" max="200" step="5" oninput="updateSliderValue(this); updateAnnualPrice()">
                            <span id="annualPlanPercentageValue">30%</span>
                        </div>
                        
                        <div class="input-group">
                            <label>Starting MAU
                                <span class="info-icon">?</span>
                                <span class="tooltip">Monthly Active Users at launch (Month 1). Include both free and potential paid users.</span>
                            </label>
                            <input type="number" id="startingMAU" value="1000" min="50" max="10000" step="50">
                        </div>
                        
                        <div class="input-group">
                            <label>Projection Period
                                <span class="info-icon">?</span>
                                <span class="tooltip">Select your forecast timeframe. Recommended: 2-3 years for SaaS.</span>
                            </label>
                            <select id="projectionPeriod" onchange="updateProjectionPeriod()">
                                <option value="12">1 Year (12 months)</option>
                                <option value="18">18 Months</option>
                                <option value="24">2 Years (24 months)</option>
                                <option value="36" selected>3 Years (36 months)</option>
                                <option value="48">4 Years (48 months)</option>
                                <option value="60">5 Years (60 months)</option>
                            </select>
                        </div>
                        
                        <div class="annual-price-display" id="annualPriceDisplay">
                            <strong>Effective Annual Price: £95.93</strong>
                            <small>Blended rate considering discount adoption</small>
                        </div>
                    </div>
                </div>

                <!-- Beta Period Parameters -->
                <div class="card">
                    <h2 class="card-title">🚀 Beta Period (3 Months)</h2>
                    <div class="grid" style="grid-template-columns: repeat(3, 1fr); gap: 15px;">
                        <div class="input-group">
                            <label>Beta Month 0 Users
                                <span class="info-icon">?</span>
                                <span class="tooltip">Initial user base for your beta launch.</span>
                            </label>
                            <input type="number" id="betaUsersM0" value="50" min="0" max="1000" step="10">
                        </div>
                        <div class="input-group">
                            <label>Beta Month 1 Users
                                <span class="info-icon">?</span>
                                <span class="tooltip">User base growth in second beta month.</span>
                            </label>
                            <input type="number" id="betaUsersM1" value="150" min="0" max="2000" step="25">
                        </div>
                        <div class="input-group">
                            <label>Beta Month 2 Users
                                <span class="info-icon">?</span>
                                <span class="tooltip">Final beta user count before launch.</span>
                            </label>
                            <input type="number" id="betaUsersM2" value="400" min="0" max="5000" step="50">
                        </div>
                    </div>
                    
                    <div class="grid" style="grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 15px;">
                        <!-- Beta Month 0 Costs -->
                        <div style="background: #1a1a1a; padding: 12px; border-radius: 6px;">
                            <h4 style="margin: 0 0 10px 0; color: #4ade80;">Beta Month 0 Costs</h4>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Team (£)</label>
                                <input type="number" id="betaTeamCostM0" value="2000" min="0" max="20000" step="500">
                            </div>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Tech (£)</label>
                                <input type="number" id="betaTechCostM0" value="300" min="0" max="5000" step="100">
                            </div>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Marketing (£)</label>
                                <input type="number" id="betaMarketingCostM0" value="200" min="0" max="10000" step="100">
                            </div>
                        </div>
                        
                        <!-- Beta Month 1 Costs -->
                        <div style="background: #1a1a1a; padding: 12px; border-radius: 6px;">
                            <h4 style="margin: 0 0 10px 0; color: #667eea;">Beta Month 1 Costs</h4>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Team (£)</label>
                                <input type="number" id="betaTeamCostM1" value="2500" min="0" max="20000" step="500">
                            </div>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Tech (£)</label>
                                <input type="number" id="betaTechCostM1" value="400" min="0" max="5000" step="100">
                            </div>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Marketing (£)</label>
                                <input type="number" id="betaMarketingCostM1" value="600" min="0" max="10000" step="100">
                            </div>
                        </div>
                        
                        <!-- Beta Month 2 Costs -->
                        <div style="background: #1a1a1a; padding: 12px; border-radius: 6px;">
                            <h4 style="margin: 0 0 10px 0; color: #f59e0b;">Beta Month 2 Costs</h4>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Team (£)</label>
                                <input type="number" id="betaTeamCostM2" value="3000" min="0" max="20000" step="500">
                            </div>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Tech (£)</label>
                                <input type="number" id="betaTechCostM2" value="500" min="0" max="5000" step="100">
                            </div>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Marketing (£)</label>
                                <input type="number" id="betaMarketingCostM2" value="1000" min="0" max="10000" step="100">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Growth & Conversion Parameters -->
                <div class="card">
                    <h2 class="card-title">📈 Growth Parameters</h2>
                    <div class="input-group">
                        <label for="year1Growth">Year 1 Monthly Growth (%) <span class="help-icon" title="Monthly user growth rate for months 1-12. UK health apps typically see 10-20% early growth.">?</span></label>
                        <input type="range" id="year1Growth" value="16" min="0" max="200" step="1" oninput="updateSliderValue(this)">
                        <span id="year1GrowthValue">16%</span>
                    </div>
                    
                    <div class="input-group">
                        <label for="year2Growth">Year 2 Monthly Growth (%) <span class="help-icon" title="Monthly user growth rate for months 13-24 as growth naturally slows.">?</span></label>
                        <input type="range" id="year2Growth" value="12" min="0" max="200" step="1" oninput="updateSliderValue(this)">
                        <span id="year2GrowthValue">12%</span>
                    </div>
                    
                    <div class="input-group">
                        <label for="year3Growth">Year 3+ Monthly Growth (%) <span class="help-icon" title="Sustainable long-term growth rate for mature app phase.">?</span></label>
                        <input type="range" id="year3Growth" value="8" min="0" max="200" step="1" oninput="updateSliderValue(this)">
                        <span id="year3GrowthValue">8%</span>
                    </div>
                </div>

                <!-- Conversion & Churn Parameters -->
                <div class="card">
                    <h2 class="card-title">🎯 Conversion & Churn Parameters</h2>
                    <div class="grid" style="grid-template-columns: repeat(2, 1fr); gap: 20px;">
                        <div class="input-group">
                            <label for="initialConversion">Initial Conversion Rate (%) <span class="help-icon" title="Monthly conversion rate from free to paid users (start conservative).">?</span></label>
                            <input type="range" id="initialConversion" value="2.5" min="0" max="200" step="0.1" oninput="updateSliderValue(this)">
                            <span id="initialConversionValue">2.5%</span>
                        </div>
                        
                        <div class="input-group">
                            <label for="conversionGrowth">Annual Conversion Growth (%) <span class="help-icon" title="How much conversion rate improves each year due to product improvements.">?</span></label>
                            <input type="range" id="conversionGrowth" value="15" min="0" max="200" step="1" oninput="updateSliderValue(this)">
                            <span id="conversionGrowthValue">15%</span>
                        </div>
                        
                        <div class="input-group">
                            <label for="freeChurnRate">Free User Churn Rate (%) <span class="help-icon" title="Monthly churn rate for free users. Health apps typically see 15-25%.">?</span></label>
                            <input type="range" id="freeChurnRate" value="20" min="0" max="200" step="1" oninput="updateSliderValue(this)">
                            <span id="freeChurnRateValue">20%</span>
                        </div>
                        
                        <div class="input-group">
                            <label for="paidChurnRate">Paid User Churn Rate (%) <span class="help-icon" title="Monthly churn rate for paying customers. Premium health apps typically see 3-8%.">?</span></label>
                            <input type="range" id="paidChurnRate" value="5" min="0" max="200" step="0.5" oninput="updateSliderValue(this)">
                            <span id="paidChurnRateValue">5%</span>
                        </div>
                        
                        <div class="input-group">
                            <label for="churnImprovement">Churn Improvement Factor (%) <span class="help-icon" title="How much churn reduces each year as product improves (10% = 10% improvement per year).">?</span></label>
                            <input type="range" id="churnImprovement" value="10" min="0" max="200" step="1" oninput="updateSliderValue(this)">
                            <span id="churnImprovementValue">10%</span>
                        </div>
                        
                        <div class="input-group">
                            <label>B2B Revenue Start (Month)
                                <span class="info-icon">?</span>
                                <span class="tooltip">When B2B partnerships begin contributing revenue.</span>
                            </label>
                            <input type="number" id="b2bStartMonth" value="18" min="6" max="48" step="1">
                        </div>
                        
                        <div class="input-group">
                            <label for="b2bPercentage">B2B Revenue Boost (%) <span class="help-icon" title="Additional revenue from B2B partnerships as % of consumer revenue.">?</span></label>
                            <input type="range" id="b2bPercentage" value="15" min="0" max="200" step="5" oninput="updateSliderValue(this)">
                            <span id="b2bPercentageValue">15%</span>
                        </div>
                    </div>
                </div>
                
                <!-- Investment & Valuation Parameters -->
                <div class="card">
                    <h2 class="card-title">💰 Investment & Valuation</h2>
                    <div class="grid" style="grid-template-columns: repeat(2, 1fr); gap: 20px;">
                        <div class="input-group">
                            <label>Seed Investment (£)
                                <span class="info-icon">?</span>
                                <span class="tooltip">Initial funding to cover runway until break-even or next round.</span>
                            </label>
                            <input type="number" id="seedInvestment" value="150000" min="10000" max="2000000" step="10000">
                        </div>
                        
                        <div class="input-group">
                            <label for="equityOffered">Equity Given Away (%) <span class="help-icon" title="Percentage of company equity offered to investors.">?</span></label>
                            <input type="range" id="equityOffered" value="20" min="0" max="200" step="1" oninput="updateSliderValue(this)">
                            <span id="equityOfferedValue">20%</span>
                        </div>
                        
                        <div class="input-group">
                            <label for="valuationMultiple">Exit Valuation Multiple <span class="help-icon" title="Revenue multiple for exit valuation. SaaS typically 5-15x ARR.">?</span></label>
                            <input type="range" id="valuationMultiple" value="8" min="0" max="200" step="0.5" oninput="updateSliderValue(this)">
                            <span id="valuationMultipleValue">8</span>
                        </div>
                    </div>
                </div>
                
                <!-- Cost & Investment Parameters -->
                <div class="card">
                    <h2 class="card-title">💰 Cost Structure</h2>
                    <div class="grid" style="grid-template-columns: repeat(3, 1fr); gap: 20px;">
                        <!-- Team Costs Group -->
                        <div style="background: #1a1a1a; padding: 15px; border-radius: 8px; border-top: 3px solid #4ade80;">
                            <h3 style="color: #4ade80; margin: 0 0 15px 0; font-size: 1.1rem;">👥 Team Costs</h3>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Year 1 (£/month)
                                    <span class="info-icon">?</span>
                                    <span class="tooltip">Monthly salaries, benefits, etc. Start small with founders + 1-2 key hires.</span>
                                </label>
                                <input type="number" id="teamCostY1" value="4500" min="1000" max="50000" step="500" style="padding: 8px;">
                            </div>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Year 2 (£/month)
                                    <span class="info-icon">?</span>
                                    <span class="tooltip">Growing team as you scale. Add developers, designer, marketer.</span>
                                </label>
                                <input type="number" id="teamCostY2" value="12000" min="2000" max="100000" step="1000" style="padding: 8px;">
                            </div>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Year 3+ (£/month)
                                    <span class="info-icon">?</span>
                                    <span class="tooltip">Mature team size for scale operations.</span>
                                </label>
                                <input type="number" id="teamCostY3" value="25000" min="5000" max="200000" step="2500" style="padding: 8px;">
                            </div>
                            <div class="input-group">
                                <label style="display: flex; align-items: center; gap: 8px; font-size: 0.9rem;">
                                    <input type="checkbox" id="enableMonthlyTeamCosts" onchange="toggleMonthlyTeamCosts()">
                                    Monthly Detail View
                                </label>
                            </div>
                        </div>
                        
                        <!-- Tech Costs Group -->
                        <div style="background: #1a1a1a; padding: 15px; border-radius: 8px; border-top: 3px solid #667eea;">
                            <h3 style="color: #667eea; margin: 0 0 15px 0; font-size: 1.1rem;">🔧 Technology Costs</h3>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Year 1 (£/month)
                                    <span class="info-icon">?</span>
                                    <span class="tooltip">Servers, tools, licenses, APIs. Start lean but scalable.</span>
                                </label>
                                <input type="number" id="techCostY1" value="800" min="100" max="10000" step="100" style="padding: 8px;">
                            </div>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Year 2 (£/month)
                                    <span class="info-icon">?</span>
                                    <span class="tooltip">Growing infrastructure needs as user base expands.</span>
                                </label>
                                <input type="number" id="techCostY2" value="1800" min="200" max="20000" step="200" style="padding: 8px;">
                            </div>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Year 3+ (£/month)
                                    <span class="info-icon">?</span>
                                    <span class="tooltip">Enterprise-grade infrastructure for scale.</span>
                                </label>
                                <input type="number" id="techCostY3" value="4000" min="500" max="50000" step="500" style="padding: 8px;">
                            </div>
                            <div class="input-group">
                                <label style="display: flex; align-items: center; gap: 8px; font-size: 0.9rem;">
                                    <input type="checkbox" id="enableMonthlyTechCosts" onchange="toggleMonthlyTechCosts()">
                                    Monthly Detail View
                                </label>
                            </div>
                        </div>
                        
                        <!-- Marketing Costs Group -->
                        <div style="background: #1a1a1a; padding: 15px; border-radius: 8px; border-top: 3px solid #f59e0b;">
                            <h3 style="color: #f59e0b; margin: 0 0 15px 0; font-size: 1.1rem;">📢 Marketing Costs</h3>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Year 1 (£/month)
                                    <span class="info-icon">?</span>
                                    <span class="tooltip">Early marketing spend. Focus on content, community, organic growth.</span>
                                </label>
                                <input type="number" id="marketingCostY1" value="1200" min="0" max="20000" step="200" style="padding: 8px;">
                            </div>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Year 2 (£/month)
                                    <span class="info-icon">?</span>
                                    <span class="tooltip">Scaling paid acquisition channels (Google, Facebook, partnerships).</span>
                                </label>
                                <input type="number" id="marketingCostY2" value="3500" min="0" max="50000" step="500" style="padding: 8px;">
                            </div>
                            <div class="input-group">
                                <label style="font-size: 0.9rem;">Year 3+ (£/month)
                                    <span class="info-icon">?</span>
                                    <span class="tooltip">Full-scale marketing machine across all channels.</span>
                                </label>
                                <input type="number" id="marketingCostY3" value="8000" min="0" max="100000" step="1000" style="padding: 8px;">
                            </div>
                            <div class="input-group">
                                <label style="display: flex; align-items: center; gap: 8px; font-size: 0.9rem;">
                                    <input type="checkbox" id="enableMonthlyMarketingCosts" onchange="toggleMonthlyMarketingCosts()">
                                    Monthly Detail View
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Monthly Detail Sections (Hidden by Default) -->
                    <div id="monthlyTeamCostsSection" style="display: none; margin-top: 20px;">
                        <h4 style="color: #4ade80;">👥 Monthly Team Cost Breakdown</h4>
                        <div style="background: #1a1a1a; padding: 15px; border-radius: 8px; border-left: 3px solid #4ade80;">
                            <p style="margin: 0 0 10px 0; color: #ccc; font-size: 0.9rem;">
                                Customize team costs month by month for precise planning:
                            </p>
                            <button onclick="openMonthlyEditor('team')" style="background: #4ade80; color: #000; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">
                                Edit Monthly Team Costs
                            </button>
                        </div>
                    </div>
                    
                    <div id="monthlyTechCostsSection" style="display: none; margin-top: 20px;">
                        <h4 style="color: #667eea;">🔧 Monthly Tech Cost Breakdown</h4>
                        <div style="background: #1a1a1a; padding: 15px; border-radius: 8px; border-left: 3px solid #667eea;">
                            <p style="margin: 0 0 10px 0; color: #ccc; font-size: 0.9rem;">
                                Plan infrastructure scaling month by month:
                            </p>
                            <button onclick="openMonthlyEditor('tech')" style="background: #667eea; color: #fff; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">
                                Edit Monthly Tech Costs
                            </button>
                        </div>
                    </div>
                    
                    <div id="monthlyMarketingCostsSection" style="display: none; margin-top: 20px;">
                        <h4 style="color: #f59e0b;">📢 Monthly Marketing Cost Breakdown</h4>
                        <div style="background: #1a1a1a; padding: 15px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                            <p style="margin: 0 0 10px 0; color: #ccc; font-size: 0.9rem;">
                                Plan your marketing spend and campaigns month by month:
                            </p>
                            <button onclick="openMonthlyEditor('marketing')" style="background: #f59e0b; color: #000; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">
                                Edit Monthly Marketing Costs
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="sidebar-column">
                <!-- B2B, Advanced Pricing, etc. -->
                <div class="card">
                    <h2 class="card-title">💎 Advanced Features</h2>
                    
                    <div class="feature-toggle">
                        <label for="enableTieredPricing">
                            <input type="checkbox" id="enableTieredPricing" onchange="toggleTieredPricing()">
                            <strong>Enable Tiered Pricing</strong>
                            <p>Model freemium with four tiers: Free (Calorie Tracker), Premium (Journal Access), Pro (Glucose Prediction), and Max (CGM Integration).</p>
                        </label>
                    </div>
                    
                    <!-- Tiered Pricing Configuration Section -->
                    <div id="tieredPricingSection" style="display: none; margin-top: 15px; background: #1a1a1a; padding: 15px; border-radius: 8px; border-left: 3px solid #8b5cf6;">
                        <h4 style="color: #8b5cf6; margin: 0 0 15px 0;">Tier Configuration</h4>
                        
                        <!-- Tier 1: Free -->
                        <div style="margin-bottom: 15px; padding: 10px; background: #0f0f0f; border-radius: 6px;">
                            <label style="display: block; font-weight: bold; color: #4ade80; margin-bottom: 8px;">Tier 1 (Free)</label>
                            <div style="display: grid; grid-template-columns: 2fr 1fr 2fr 1fr; gap: 8px; align-items: center;">
                                <input type="text" value="Free" disabled style="background: #2a2a2a; color: #ccc; padding: 6px; border: 1px solid #444; border-radius: 4px;">
                                <input type="number" value="0" disabled style="background: #2a2a2a; color: #ccc; padding: 6px; border: 1px solid #444; border-radius: 4px;">
                                <div class="tier-setting">
                                    <label>Free to Premium (%)</label>
                                    <input type="range" id="tier1Conversion" min="0" max="200" value="70" style="width: 100%;">
                                    <span>70%</span>
                                </div>
                            </div>
                            <p style="margin: 5px 0 0 0; font-size: 0.8rem; color: #999;">Features: Calorie tracking, basic food logging</p>
                        </div>
                        
                        <!-- Tier 2: Premium -->
                        <div style="margin-bottom: 15px; padding: 10px; background: #0f0f0f; border-radius: 6px;">
                            <label style="display: block; font-weight: bold; color: #667eea; margin-bottom: 8px;">Tier 2 (Premium)</label>
                            <div style="display: grid; grid-template-columns: 2fr 1fr 2fr 1fr; gap: 8px; align-items: center;">
                                <input type="text" value="Premium" disabled style="background: #2a2a2a; color: #ccc; padding: 6px; border: 1px solid #444; border-radius: 4px;">
                                <input type="number" id="basicPrice" value="4.99" min="0" step="0.01" style="background: #1a1a1a; color: #fff; padding: 6px; border: 1px solid #444; border-radius: 4px;">
                                <div class="tier-setting">
                                    <label>Basic Tier (%)</label>
                                    <input type="range" id="basicConversion" min="0" max="200" value="20" style="width: 100%;" oninput="updateSliderValue(this)">
                                    <span id="basicConversionValue">20%</span>
                                </div>
                            </div>
                            <p style="margin: 5px 0 0 0; font-size: 0.8rem; color: #999;">Features: Journal access, meal planning, basic insights</p>
                        </div>
                        
                        <!-- Tier 3: Pro -->
                        <div style="margin-bottom: 15px; padding: 10px; background: #0f0f0f; border-radius: 6px;">
                            <label style="display: block; font-weight: bold; color: #f59e0b; margin-bottom: 8px;">Tier 3 (Pro)</label>
                            <div style="display: grid; grid-template-columns: 2fr 1fr 2fr 1fr; gap: 8px; align-items: center;">
                                <input type="text" value="Pro" disabled style="background: #2a2a2a; color: #ccc; padding: 6px; border: 1px solid #444; border-radius: 4px;">
                                <input type="number" id="proPrice" value="9.99" min="0" step="0.01" style="background: #1a1a1a; color: #fff; padding: 6px; border: 1px solid #444; border-radius: 4px;">
                                <div class="tier-setting">
                                    <label>Pro Tier (%)</label>
                                    <input type="range" id="proConversion" min="0" max="200" value="8" style="width: 100%;" oninput="updateSliderValue(this)">
                                    <span id="proConversionValue">8%</span>
                                </div>
                            </div>
                            <p style="margin: 5px 0 0 0; font-size: 0.8rem; color: #999;">Features: Glucose prediction, advanced journal, AI insights</p>
                        </div>
                        
                        <!-- Tier 4: Max -->
                        <div style="margin-bottom: 15px; padding: 10px; background: #0f0f0f; border-radius: 6px;">
                            <label style="display: block; font-weight: bold; color: #ef4444; margin-bottom: 8px;">Tier 4 (Max)</label>
                            <div style="display: grid; grid-template-columns: 2fr 1fr 2fr 1fr; gap: 8px; align-items: center;">
                                <input type="text" value="Max" disabled style="background: #2a2a2a; color: #ccc; padding: 6px; border: 1px solid #444; border-radius: 4px;">
                                <input type="number" id="enterprisePrice" value="19.99" min="0" step="0.01" style="background: #1a1a1a; color: #fff; padding: 6px; border: 1px solid #444; border-radius: 4px;">
                                <div class="tier-setting">
                                    <label>Enterprise Tier (%)</label>
                                    <input type="range" id="enterpriseConversion" min="0" max="200" value="2" style="width: 100%;" oninput="updateSliderValue(this)">
                                    <span id="enterpriseConversionValue">2%</span>
                                </div>
                            </div>
                            <p style="margin: 5px 0 0 0; font-size: 0.8rem; color: #999;">Features: CGM integration, real-time glucose monitoring, premium support</p>
                        </div>
                    </div>
                    <div class="feature-toggle">
                        <label for="enableCohortTracking">
                            <input type="checkbox" id="enableCohortTracking" onchange="toggleCohortTracking()">
                            <strong>Enable Cohort Tracking</strong>
                            <p>Track user retention and revenue by signup month to analyze cohort performance.</p>
                        </label>
                    </div>
                    <div class="feature-toggle">
                        <label for="enableVariableCosts">
                            <input type="checkbox" id="enableVariableCosts" onchange="toggleVariableCosts()">
                            <strong>Enable Variable Costs</strong>
                            <p>Add costs that scale with user growth (support, infrastructure, etc.).</p>
                        </label>
                    </div>
                     <div class="feature-toggle">
                        <label for="enableMultipleRounds">
                            <input type="checkbox" id="enableMultipleRounds" onchange="toggleMultipleRounds()">
                            <strong>Enable Multiple Funding Rounds</strong>
                            <p>Model Series A, B, C funding rounds with dilution tracking.</p>
                        </label>
                    </div>
                    
                    <!-- Variable Costs Section -->
                    <div id="variableCostsSection" style="display: none; margin-top: 15px; background: #1a1a1a; padding: 15px; border-radius: 8px; border-left: 3px solid #10b981;">
                        <h4 style="color: #10b981; margin: 0 0 15px 0;">Variable Cost Configuration</h4>
                        <div class="input-group">
                            <label>Support Cost per User (£/month)
                                <span class="info-icon">?</span>
                                <span class="tooltip">Monthly support cost that scales with active users.</span>
                            </label>
                            <input type="number" id="supportCostPerUser" value="0.15" min="0" max="5" step="0.05">
                        </div>
                        <div class="input-group">
                            <label>Infrastructure Cost per User (£/month)
                                <span class="info-icon">?</span>
                                <span class="tooltip">Server and infrastructure costs that scale with usage.</span>
                            </label>
                            <input type="number" id="infraCostPerUser" value="0.08" min="0" max="2" step="0.01">
                        </div>
                        <div class="input-group">
                            <label for="transactionFees">Transaction Fees (%) <span class="help-icon" title="Processing fees for payments (Stripe ~2.9%, PayPal ~3.5%, Apple/Google ~30%).">?</span></label>
                            <input type="range" id="transactionFees" value="4.5" min="0" max="200" step="0.5" oninput="updateSliderValue(this)">
                            <span id="transactionFeesValue">4.5%</span>
                        </div>
                        
                        <!-- Sensitivity Analysis -->
                        <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #333;">
                            <h5 style="color: #f59e0b; margin: 0 0 10px 0;">💡 Sensitivity Analysis</h5>
                            <p style="font-size: 0.85rem; color: #ccc; margin-bottom: 10px;">Quick test different variable cost scenarios to see impact on runway:</p>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;">
                                <button onclick="setVariableCostScenario('low')" class="scenario-btn" style="background: #10b981; font-size: 0.8rem; padding: 8px;">
                                    Low (£1.00/user)
                                </button>
                                <button onclick="setVariableCostScenario('medium')" class="scenario-btn" style="background: #f59e0b; font-size: 0.8rem; padding: 8px;">
                                    Medium (£1.50/user)
                                </button>
                                <button onclick="setVariableCostScenario('high')" class="scenario-btn" style="background: #ef4444; font-size: 0.8rem; padding: 8px;">
                                    High (£2.00/user)
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Multiple Funding Rounds Section -->
                    <div id="multipleRoundsSection" style="display: none; margin-top: 15px; background: #1a1a1a; padding: 15px; border-radius: 8px; border-left: 3px solid #f59e0b;">
                        <h4 style="color: #f59e0b; margin: 0 0 15px 0;">Multiple Funding Rounds</h4>
                        
                        <!-- Series A -->
                        <div style="margin-bottom: 15px; padding: 10px; background: #0f0f0f; border-radius: 6px;">
                            <h5 style="color: #667eea; margin: 0 0 10px 0;">Series A</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px;">
                                <div class="input-group">
                                    <label style="font-size: 0.8rem;">Month</label>
                                    <input type="number" id="seriesAMonth" value="15" min="6" max="60">
                                </div>
                                <div class="input-group">
                                    <label style="font-size: 0.8rem;">Amount (£)</label>
                                    <input type="number" id="seriesAAmount" value="500000" min="100000" max="10000000" step="50000">
                                </div>
                                <div class="input-group">
                                    <label style="font-size: 0.8rem;">Equity (%)</label>
                                    <input type="number" id="seriesAEquity" value="25" min="5" max="50" step="1">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Series B -->
                        <div style="margin-bottom: 15px; padding: 10px; background: #0f0f0f; border-radius: 6px;">
                            <h5 style="color: #10b981; margin: 0 0 10px 0;">Series B</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px;">
                                <div class="input-group">
                                    <label style="font-size: 0.8rem;">Month</label>
                                    <input type="number" id="seriesBMonth" value="30" min="12" max="60">
                                </div>
                                <div class="input-group">
                                    <label style="font-size: 0.8rem;">Amount (£)</label>
                                    <input type="number" id="seriesBAmount" value="2000000" min="500000" max="50000000" step="100000">
                                </div>
                                <div class="input-group">
                                    <label style="font-size: 0.8rem;">Equity (%)</label>
                                    <input type="number" id="seriesBEquity" value="20" min="5" max="40" step="1">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Scenarios & Save/Load -->
                <div class="card">
                    <h2 class="card-title">🎯 Quick Scenarios</h2>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                        <button class="calculate-btn scenario-btn" onclick="loadScenario('conservative')" style="background: #6b7280;">Conservative</button>
                        <button class="calculate-btn scenario-btn" onclick="loadScenario('realistic')" style="background: #667eea;">Realistic</button>
                        <button class="calculate-btn scenario-btn" onclick="loadScenario('optimistic')" style="background: #10b981;">Optimistic</button>
                        <button class="calculate-btn scenario-btn" onclick="loadScenario('investor')" style="background: #f59e0b;">Investor Ready</button>
                    </div>
                </div>
                <div class="card">
                    <h2 class="card-title">💾 Save & Load Projections</h2>
                    <div class="save-load-controls">
                        <input type="text" id="projectionName" placeholder="Enter projection name...">
                        <button class="action-button" onclick="saveScenario()">Save</button>
                    </div>
                    <div id="savedScenarios"></div>
                </div>
            </div>
        </div>

        <!-- Moved Generate Projections Button -->
        <div class="card generate-card">
            <h3 class="generate-title">🚀 Generate Your Financial Projections</h3>
            <p class="generate-subtitle">✅ Enter all your parameters, then click below to calculate.</p>
            <button id="calculateBtn" class="cta-button" onclick="calculateProjections(true)">🚀 Calculate Projections</button>
            <p id="calculationStatus" class="status-message"></p>
        </div>

        <!-- Financial Projections Output -->
        <div id="outputSection" class="results-container" style="display:none;">
            <div class="card">
                <h2 class="card-title">📊 Financial Projections Summary</h2>
                
                <!-- Key Metrics Grid -->
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-label">Final MAU</div>
                        <div class="summary-value" id="finalMAU">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Final ARR</div>
                        <div class="summary-value" id="finalARR">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Break-even Month</div>
                        <div class="summary-value" id="breakEvenMonth">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Exit Valuation</div>
                        <div class="summary-value" id="exitValuation">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Investor Return</div>
                        <div class="summary-value" id="investorReturn">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Total Revenue</div>
                        <div class="summary-value" id="totalRevenue">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Total Costs</div>
                        <div class="summary-value" id="totalCosts">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Net Profit</div>
                        <div class="summary-value" id="netProfit">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">LTV:CAC Ratio</div>
                        <div class="summary-value" id="ltvCacRatio">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Customer LTV</div>
                        <div class="summary-value" id="customerLTV">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Monthly ARPU</div>
                        <div class="summary-value" id="monthlyARPU">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Customer CAC</div>
                        <div class="summary-value" id="customerCAC">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Runway</div>
                        <div class="summary-value" id="runway">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Burn Rate</div>
                        <div class="summary-value" id="burnRate">-</div>
                    </div>
                </div>
            </div>

            <!-- Breakdown Cards Grid Container -->
            <div class="breakdown-grid">
                <!-- CAC Breakdown Card -->
                <div class="metric-box">
                    <h4 class="metric-box-title">💰 Customer Acquisition Cost</h4>
                    <div class="metric-box-content">
                        <div class="metric-item">
                            <span class="metric-label">Total Marketing:</span>
                            <span class="metric-value" id="totalMarketingCosts">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Sales Overhead:</span>
                            <span class="metric-value" id="salesOverhead">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Total Acquisition:</span>
                            <span class="metric-value" id="totalAcquisitionCosts">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Users Acquired:</span>
                            <span class="metric-value" id="totalUsersAcquiredDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Average CAC:</span>
                            <span class="metric-value" id="averageCACDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Payback Period:</span>
                            <span class="metric-value" id="paybackPeriod">-</span>
                        </div>
                    </div>
                </div>

                <!-- Variable Costs Breakdown Card -->
                <div class="metric-box" id="variableCostBreakdownCard" style="display: none;">
                    <h4 class="metric-box-title">⚙️ Variable Costs</h4>
                    <div class="metric-box-content">
                        <div class="metric-item">
                            <span class="metric-label">Infrastructure:</span>
                            <span class="metric-value" id="totalInfraCosts">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Support:</span>
                            <span class="metric-value" id="totalSupportCosts">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Transaction Fees:</span>
                            <span class="metric-value" id="totalTransactionFees">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Total Variable:</span>
                            <span class="metric-value" id="totalVariableCostsDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Avg Monthly:</span>
                            <span class="metric-value" id="avgMonthlyVariableCosts">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Cost per User:</span>
                            <span class="metric-value" id="variableCostPerUser">-</span>
                        </div>
                    </div>
                </div>

                <!-- Conversion Rate Breakdown Card -->
                <div class="metric-box">
                    <h4 class="metric-box-title">🎯 Conversion Rates</h4>
                    <div class="metric-box-content">
                        <div class="metric-item">
                            <span class="metric-label">Initial Rate:</span>
                            <span class="metric-value" id="initialConversionDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Final Rate:</span>
                            <span class="metric-value" id="finalConversionDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Average Rate:</span>
                            <span class="metric-value" id="avgConversionDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Annual Growth:</span>
                            <span class="metric-value" id="conversionImprovementDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Peak Rate:</span>
                            <span class="metric-value" id="peakConversionDisplay">-</span>
                        </div>
                    </div>
                </div>

                <!-- User Growth Breakdown Card -->
                <div class="metric-box">
                    <h4 class="metric-box-title">👥 User Growth</h4>
                    <div class="metric-box-content">
                        <div class="metric-item">
                            <span class="metric-label">Starting MAU:</span>
                            <span class="metric-value" id="startingMAUDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Final MAU:</span>
                            <span class="metric-value" id="finalMAUDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Total Growth:</span>
                            <span class="metric-value" id="totalGrowthDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Avg Monthly:</span>
                            <span class="metric-value" id="avgMonthlyGrowthDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Premium Users:</span>
                            <span class="metric-value" id="finalPremiumUsersDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Premium Growth:</span>
                            <span class="metric-value" id="premiumUserGrowthDisplay">-</span>
                        </div>
                    </div>
                </div>

                <!-- Team & Tech Costs Breakdown Card -->
                <div class="metric-box">
                    <h4 class="metric-box-title">💼 Team & Tech Costs</h4>
                    <div class="metric-box-content">
                        <div class="metric-item">
                            <span class="metric-label">Total Team:</span>
                            <span class="metric-value" id="totalTeamCostsDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Total Tech:</span>
                            <span class="metric-value" id="totalTechCostsDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Avg Team/Month:</span>
                            <span class="metric-value" id="avgMonthlyTeamCostDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Avg Tech/Month:</span>
                            <span class="metric-value" id="avgMonthlyTechCostDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Team per User:</span>
                            <span class="metric-value" id="teamCostPerUserDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Tech per User:</span>
                            <span class="metric-value" id="techCostPerUserDisplay">-</span>
                        </div>
                    </div>
                </div>

                <!-- Marketing Efficiency Breakdown Card -->
                <div class="metric-box">
                    <h4 class="metric-box-title">📢 Marketing Efficiency</h4>
                    <div class="metric-box-content">
                        <div class="metric-item">
                            <span class="metric-label">Total Spend:</span>
                            <span class="metric-value" id="totalMarketingSpendDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Avg Monthly:</span>
                            <span class="metric-value" id="avgMonthlyMarketingDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Cost per User:</span>
                            <span class="metric-value" id="marketingPerUserDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Marketing ROI:</span>
                            <span class="metric-value" id="marketingROIDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Revenue per £:</span>
                            <span class="metric-value" id="revenuePerMarketingDisplay">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Efficiency Trend:</span>
                            <span class="metric-value" id="marketingEfficiencyTrendDisplay">-</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Monthly Projections Table -->
            <div class="card">
                <h3 class="card-title">📈 Monthly Projections</h3>
                <div class="table-container">
                    <table id="monthlyTable" class="projection-table">
                        <thead>
                            <tr>
                                <th>Month</th>
                                <th>MAU</th>
                                <th>Growth Rate (%)</th>
                                <th>Free Users</th>
                                <th style="display: none;">Basic Users</th>
                                <th style="display: none;">Pro Users</th>
                                <th style="display: none;" id="enterpriseHeader">Enterprise Users</th>
                                <th>Premium Users</th>
                                <th>Conversion Rate</th>
                                <th>Monthly Revenue</th>
                                <th>ARR</th>
                                <th>Team Cost</th>
                                <th>Tech Cost</th>
                                <th>Marketing Cost</th>
                                <th>Variable Costs</th>
                                <th>Total Costs</th>
                                <th>Net Income</th>
                            </tr>
                        </thead>
                        <tbody id="monthlyTableBody">
                            <!-- Monthly data will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Chart Container -->
            <div class="card">
                <h3 class="card-title">📊 Financial Chart</h3>
                <div class="chart-container">
                    <canvas id="projectionChart"></canvas>
                </div>
            </div>

            <!-- Export Controls -->
            <div class="card">
                <h3 class="card-title">💾 Export Results</h3>
                <div class="export-controls">
                    <button onclick="exportToPDF()" class="export-btn">📄 Export PDF Report</button>
                    <button onclick="exportToCSV()" class="export-btn">📊 Export CSV Data</button>
                    <button onclick="exportScreenshot()" class="export-btn">📸 Export Screenshot</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Chart.js for visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- jsPDF for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    
    <!-- HTML2Canvas for screenshot functionality -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        // Ensure libraries load before main script
        window.addEventListener('load', function() {
            console.log('Page loaded');
            console.log('jsPDF available:', typeof window.jspdf);
            if (window.jspdf && window.jspdf.jsPDF) {
                console.log('jsPDF constructor available:', typeof window.jspdf.jsPDF);
            }
            if (typeof jsPDFAutoTable !== 'undefined') {
                console.log('AutoTable plugin loaded:', typeof jsPDFAutoTable);
            }
        });
    </script>
    <!-- Load JavaScript modules in dependency order -->
    <script src="js/utils.js"></script>
    <script src="js/core.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/export.js"></script>
    <script src="js/scenarios.js"></script>
    <script src="js/ui.js"></script>
</body>
</html> 